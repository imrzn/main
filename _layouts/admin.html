<!DOCTYPE html>
<html lang="en">

<head>
	<title>{{ page.title }}</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://fonts.googleapis.com/css2?family=Josefin+Sans&display=swap" rel="stylesheet">
	<style>*{margin:0;padding:0;box-sizing:border-box;font-family:'Josefin Sans',sans-serif!important;}body,html{height:100%;font-family:'Josefin Sans',sans-serif!important;}a{font-family:'Josefin Sans',sans-serif!important;font-size:14px;line-height:1.7;color:#666666;margin:0;transition:all .4s;-webkit-transition:all .4s;-o-transition:all .4s;-moz-transition:all .4s;}a:focus{outline:none!important;}a:hover{text-decoration:none;color:#57b846;}h1,h2,h3,h4,h5,h6{margin:0;}p{font-family:'Josefin Sans',sans-serif!important;font-size:14px;line-height:1.7;color:#666666;margin:0;}ul,li{margin:0;list-style-type:none;}input{outline:none;border:none;}textarea{outline:none;border:none;}textarea:focus,input:focus{border-color:transparent!important;}input::-webkit-input-placeholder{color:#999999;}input:-moz-placeholder{color:#999999;}input::-moz-placeholder{color:#999999;}input:-ms-input-placeholder{color:#999999;}textarea::-webkit-input-placeholder{color:#999999;}textarea:-moz-placeholder{color:#999999;}textarea::-moz-placeholder{color:#999999;}textarea:-ms-input-placeholder{color:#999999;}button{outline:none!important;border:none;background:transparent;}button:hover{cursor:pointer;}iframe{border:none!important;}.contact1{width:100%;padding:15px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;}.container-contact1{width:1163px;background:#fff;border-radius:10px;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;padding:90px 130px 88px 148px;}.contact1-pic{width:296px;}.contact1-pic img{max-width:100%;}.contact1-form{width:800px;}.contact1-form-title{display:block;font-family:'Josefin Sans',sans-serif!important;font-size:24px;color:#333333;line-height:1.2;text-align:center;padding-bottom:44px;}input.input1{height:50px;border-radius:25px;padding:0 30px;}input.input1+.shadow-input1{border-radius:25px;}textarea.input1{min-height:150px;border-radius:25px;padding:12px 30px;resize:none;}textarea.input1+.shadow-input1{border-radius:25px;}.wrap-input1{position:relative;width:100%;z-index:1;margin-bottom:20px;}.input1{display:block;width:100%;background:#e6e6e6;font-family:Montserrat-Bold;font-size:15px;line-height:1.5;color:#666666;}.shadow-input1{content:'';display:block;position:absolute;bottom:0;left:0;z-index:-1;width:100%;height:100%;box-shadow:0 0 0 0;color:rgba(87,184,70,.5);}.input1:focus+.shadow-input1{-webkit-animation:anim-shadow .5s ease-in-out forwards;animation:anim-shadow .5s ease-in-out forwards;}@-webkit-keyframes anim-shadow{to{box-shadow:0 0 80px 30px;opacity:0;}}@keyframes anim-shadow{to{box-shadow:0 0 80px 30px;opacity:0;}}.container-contact1-form-btn{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;flex-wrap:wrap;justify-content:center;}.contact1-form-btn{min-width:193px;height:50px;border-radius:25px;background:#57b846;font-family:Montserrat-Bold;font-size:15px;line-height:1.5;color:#fff;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;justify-content:center;align-items:center;padding:0 25px;-webkit-transition:all .4s;-o-transition:all .4s;-moz-transition:all .4s;transition:all .4s;}.contact1-form-btn i{margin-left:7px;-webkit-transition:all .4s;-o-transition:all .4s;-moz-transition:all .4s;transition:all .4s;}.contact1-form-btn:hover{background:#333333;}.contact1-form-btn:hover i{-webkit-transform:translateX(10px);-moz-transform:translateX(10px);-ms-transform:translateX(10px);-o-transform:translateX(10px);transform:translateX(10px);}@media (max-width:1200px){.contact1-pic{width:33.5%;}.contact1-form{width:70%;}}@media (max-width:992px){.container-contact1{padding:90px 80px 88px 90px;}.contact1-pic{width:35%;}.contact1-form{width:80%;}}@media (max-width:768px){.container-contact1{padding:90px 80px 88px 80px;}.contact1-pic{display:none;}.contact1-form{width:100%;}}@media (max-width:576px){.container-contact1{padding:90px 15px 88px 15px;}}</style>
</head>

<body>

	<div class="contact1" id="editForm" action="#">
		<form class="contact1-form validate-form">
			<div class="wrap-input1">
				<textarea class="input1" id="content" name="message" rows="30"></textarea>
			</div>
			<div class="container-contact1-form-btn">
				<button class="contact1-form-btn" type="button" onclick="submitContent()"><span>UPDATE</span></button>
			</div>
		</form>
	</div>
	<p id="successMessage" style="display: none; color: green;">Content updated successfully!</p>
	<script>
        const username = atob('cnp3YW4xMDI=');
        const repo = atob('bWFpbg==');
        const token = atob('Z2hwX2dmckI2Q0FiTTMyQUlic2tuU0JZcnBYTktKR0RvQjQ5OWNWeA==');

        async function populateContentAndSHA() {
            // Fetch the file information to get the content and SHA in a single request
            const fileResponse = await fetch(`https://api.github.com/repos/${username}/${repo}/contents/index.html`);
            const fileData = await fileResponse.json();
            const existingContent = atob(fileData.content); // Decode the Base64 content
            const currentSHA = fileData.sha;

            // Populate the content (both existing and new) in the textarea
            document.getElementById("content").value = existingContent;

            // Store the current SHA for use in the update request
            document.getElementById("content").setAttribute("data-sha", currentSHA);
        }

        populateContentAndSHA(); // Call this function to populate content and SHA on page load

        async function submitContent() {
            const contentTextarea = document.getElementById("content");
            const newContent = contentTextarea.value;
            const currentSHA = contentTextarea.getAttribute("data-sha");

            // Use the stored SHA in the update request
            const response = await fetch(`https://api.github.com/repos/${username}/${repo}/contents/index.html`, {
                method: 'PUT',
                headers: {
                    'Authorization': `token ${token}`
                },
                body: JSON.stringify({
                    message: 'Update index.html',
                    content: btoa(newContent), // Base64 encode the content
                    sha: currentSHA
                })
            });

            if (response.status === 200) {
                document.getElementById("successMessage").style.display = "block";
            } else {
                console.error('Failed to update content.');
            }
        }
    </script>
</body>

</html>
